<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta content="width=device-width, initial-scale=1.0" name="viewport">
  <title>Portfolio Details - Anyar Bootstrap Template</title>

  <!-- Favicons -->
  <link href="assets/img/favicon.png" rel="icon">
  <link href="assets/img/apple-touch-icon.png" rel="apple-touch-icon">

  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css?family=Open+Sans:300,400,600,700|Raleway:300,400,500,600,700|Poppins:300,400,500,600,700" rel="stylesheet">

  <!-- CSS Files -->
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/cropperjs/1.5.13/cropper.min.css">
  <link href="assets/vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">
  <link href="assets/css/style.css" rel="stylesheet">

  <!-- JS Files -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/cropperjs/1.5.13/cropper.min.js"></script>

  <style>
    #imageToCrop {
      width: 200px;
      height: 250px;
      border: 1px solid #ddd;
      border-radius: 5px;
      object-fit: cover;
    }
  </style>
</head>

<body>

  <!-- Header -->
  <header id="header" class="fixed-top d-flex align-items-center header-inner-pages">
    <div class="container d-flex align-items-center justify-content-between">
      <h1 class="logo"><a href="index.html">Anyar</a></h1>

      <!-- Navbar Toggler -->
      <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarContent" aria-controls="navbarContent" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>

      <!-- Navbar Links -->
      <nav id="navbar" class="navbar navbar-expand-md">
        <div class="collapse navbar-collapse" id="navbarContent">
          <ul class="navbar-nav ml-auto">
            <li class="nav-item"><a class="nav-link scrollto" href="#hero">Business</a></li>
            <li class="dropdown"><a href="#"><span>Drop Down</span> <i class="bi bi-chevron-down"></i></a>
              <ul>
                <li><a href="#">Drop Down 1</a></li>
                <li class="dropdown"><a href="#"><span>Deep Drop Down</span> <i class="bi bi-chevron-right"></i></a>
                  <ul>
                    <li><a href="#">Deep Drop Down 1</a></li>
                    <li><a href="#">Deep Drop Down 2</a></li>
                    <li><a href="#">Deep Drop Down 3</a></li>
                    <li><a href="#">Deep Drop Down 4</a></li>
                    <li><a href="#">Deep Drop Down 5</a></li>
                  </ul>
                </li>
                <li><a href="#">Drop Down 2</a></li>
                <li><a href="#">Drop Down 3</a></li>
                <li><a href="#">Drop Down 4</a></li>
              </ul>
            </li>
            <li class="nav-item"><a class="nav-link scrollto" href="#contact">Contact</a></li>
          </ul>
        </div>
      </nav>
    </div>
  </header>

  <main id="main">
    <!-- Breadcrumbs -->
    <section id="breadcrumbs" class="breadcrumbs">
      <div class="container">
        <ol>
          <li><a href="index.html">Home</a></li>
          <li>Portfolio Details</li>
        </ol>
        <h2>Portfolio Details</h2>
      </div>
    </section>

    <!-- Portfolio Details Section -->
    <section >
        <!-- Form Section -->
        <div class="container">
        <form id="photoForm">
          <div class="form-group">
            <label for="imageUpload">Upload Image</label>
            <input type="file" class="form-control" id="imageUpload" accept="image/*" required>
            <small class="instructions">Upload a clear photo for best results</small>
          </div>

          <!-- Image Preview -->
          <div class="text-center" id="cropContainer" style="display: none;">
            <img id="imageToCrop" src="" alt="To Crop">
            <button type="button" class="btn btn-secondary mt-3" onclick="applyCrop()">Apply Crop</button>
          </div>

          <div class="form-group mt-3">
            <label for="nameField">Name (Optional)</label>
            <input type="text" class="form-control" id="nameField" placeholder="Enter a name for the PDF file">
          </div>

          <div class="form-group mt-3">
            <label for="photoCount">Number of Photos</label>
            <input type="number" class="form-control" id="photoCount" value="1" min="1" max="20" required>
          </div>

          <button type="button" class="btn btn-primary mt-3" onclick="generatePDF()" disabled id="generateBtn">Generate PDF</button>
        </form>
      </div>
    </section>
  </main>

  <!-- JavaScript Files -->
  <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.5.4/dist/umd/popper.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>

  <script>
    let cropper;
    const imageToCrop = document.getElementById("imageToCrop");

    document.getElementById("imageUpload").addEventListener("change", (e) => {
      const file = e.target.files[0];
      if (file) {
        const reader = new FileReader();
        reader.onload = (event) => {
          imageToCrop.src = event.target.result;
          document.getElementById("cropContainer").style.display = "block";
          if (cropper) cropper.destroy();
          cropper = new Cropper(imageToCrop, {
            aspectRatio: 4 / 5,
            viewMode: 1,
          });
          document.getElementById("generateBtn").disabled = false;
        };
        reader.readAsDataURL(file);
      }
    });

    function applyCrop() {
      const croppedCanvas = cropper.getCroppedCanvas({ width: 200, height: 250 });
      imageToCrop.src = croppedCanvas.toDataURL("image/jpeg");
      cropper.destroy();
    }

    function generatePDF() {
      const { jsPDF } = window.jspdf;
      const doc = new jsPDF('portrait', 'mm', 'a4');
      const imgWidth = 35;
      const imgHeight = 45;
      const margin = 8;
      const docWidth = 210;
      const docHeight = 297;

      const photoCount = parseInt(document.getElementById("photoCount").value);
      let x = margin;
      let y = margin;

      for (let i = 0; i < photoCount; i++) {
        if (y + imgHeight + margin > docHeight) {
          alert("Reached maximum number of images for a single A4 page.");
          break;
        }
        if (x + imgWidth + margin > docWidth) {
          x = margin;
          y += imgHeight + margin;
        }
        doc.addImage(imageToCrop.src, 'JPEG', x, y, imgWidth, imgHeight);
        x += imgWidth + margin;
      }

      doc.setFontSize(10);
      doc.text("Â© 2024 Lifeme. All Rights Reserved.", docWidth / 2, docHeight - 10, null, null, 'center');

      const fileName = document.getElementById("nameField").value || "passport_photos";
      doc.save(`${fileName}.pdf`);
    }
  </script>
</body>

</html>